

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>cwatm.management_modules.globals &mdash; Community Water Model</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/iiasa.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Community Water Model
          

          
            
            <img src="../../../_static/IIASA_logo_white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modeldesign.html">2. Model Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publication.html">3. Publication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">4. Setup of the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">5. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../errorHandling.html">6. Error handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../listVariables.html">7. List of output variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../results.html">8. Demo of the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../todo.html">9. The Model Itself</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data.html">10. Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../calibration.html">11. Calibration tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../calibration_tutorial.html">12. Calibration tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resolution.html">13. Increasing resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zambezi.html">14. Example Zambezi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">15. License and download info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sourcecode.html">16. Source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../forum.html">17. Forum</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Community Water Model</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>cwatm.management_modules.globals</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for cwatm.management_modules.globals</h1><div class="highlight"><pre>
<span></span><span class="c1"># -------------------------------------------------------------------------</span>
<span class="c1"># Name:        globals</span>
<span class="c1"># Purpose:</span>
<span class="c1">#</span>
<span class="c1"># Author:      burekpe</span>
<span class="c1">#</span>
<span class="c1"># Created:     16/05/2016</span>
<span class="c1"># Copyright:   (c) burekpe 2016</span>

<span class="c1"># This program comes with ABSOLUTELY NO WARRANTY</span>
<span class="c1"># This is free software, and you are welcome to redistribute it under certain conditions</span>
<span class="c1"># run cwatm 1 -w for details</span>
<span class="c1"># -------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">getopt</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">numpy.ctypeslib</span> <span class="k">as</span> <span class="nn">npct</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># for detecting on which system it is running</span>
<span class="kn">import</span> <span class="nn">platform</span>

<span class="kn">from</span> <span class="nn">cwatm.management_modules.messages</span> <span class="kn">import</span> <span class="o">*</span>

<div class="viewcode-block" id="globalclear"><a class="viewcode-back" href="../../../management_modules.html#cwatm.management_modules.globals.globalclear">[docs]</a><span class="k">def</span> <span class="nf">globalclear</span><span class="p">():</span>

    <span class="n">settingsfile</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">maskinfo</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">modelSteps</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">xmlstring</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">geotrans</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">versioning</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">timestepInit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">binding</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">option</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">metaNetcdfVar</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">inputcounter</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">flagmeteo</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">meteofiles</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">initCondVarValue</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">initCondVar</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">dateVar</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">outDir</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">outMap</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">outTss</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">outsection</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">reportTimeSerieAct</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">reportMapsAll</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">reportMapsSteps</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">reportMapsEnd</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>


    <span class="n">ReportSteps</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">FilterSteps</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">EnsMembers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">nrCores</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">outputDir</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">maskmapAttr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">bigmapAttr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">metadataNCDF</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">domain</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">indexes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>


<div class="viewcode-block" id="calibclear"><a class="viewcode-back" href="../../../management_modules.html#cwatm.management_modules.globals.calibclear">[docs]</a><span class="k">def</span> <span class="nf">calibclear</span><span class="p">():</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Flags</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">Flags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">settingsfile</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="c1">#maskinfo.clear()</span>
    <span class="c1">#modelSteps.clear()</span>
    <span class="c1">#xmlstring.clear()</span>
    <span class="c1">#geotrans.clear()</span>
    <span class="c1">#versioning.clear()</span>
    <span class="c1">#timestepInit.clear()</span>
    <span class="c1">#binding.clear()</span>
    <span class="c1">#option.clear()</span>
    <span class="c1">#metaNetcdfVar.clear()</span>

    <span class="n">inputcounter</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">flagmeteo</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">meteofiles</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">initCondVarValue</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">initCondVar</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="n">dateVar</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="c1">#outDir.clear()</span>
    <span class="c1">#outMap.clear()</span>

    <span class="n">outTss</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>


    <span class="c1">#outsection.clear()</span>
    <span class="c1">#reportTimeSerieAct.clear()</span>
    <span class="c1">#reportMapsAll.clear()</span>
    <span class="c1">#reportMapsSteps.clear()</span>
    <span class="c1">#reportMapsEnd.clear()</span>


    <span class="c1">#ReportSteps.clear()</span>
    <span class="c1">#FilterSteps.clear()</span>
    <span class="c1">#EnsMembers.clear()</span>
    <span class="c1">#nrCores.clear()</span>
    <span class="c1">#outputDir.clear()</span>

    <span class="c1">#maskmapAttr.clear()</span>
    <span class="c1">#bigmapAttr.clear()</span>
    <span class="c1">#metadataNCDF.clear()</span>

    <span class="c1">#domain.clear()</span>
    <span class="c1">#indexes.clear()</span>

    <span class="n">outsection</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">outputDir</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">binding</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">option</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>



<span class="k">global</span> <span class="n">settingsfile</span>
<span class="n">settingsfile</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">global</span> <span class="n">maskinfo</span><span class="p">,</span><span class="n">zeromap</span><span class="p">,</span><span class="n">modelSteps</span><span class="p">,</span><span class="n">xmlstring</span><span class="p">,</span><span class="n">geotrans</span>
<span class="c1"># noinspection PyRedeclaration</span>
<span class="n">maskinfo</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">modelSteps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">xmlstring</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">geotrans</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">global</span> <span class="n">binding</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">FlagName</span><span class="p">,</span> <span class="n">Flags</span><span class="p">,</span> <span class="n">ReportSteps</span><span class="p">,</span> <span class="n">FilterSteps</span><span class="p">,</span> <span class="n">EnsMembers</span><span class="p">,</span> <span class="n">outputDir</span>
<span class="k">global</span> <span class="n">MMaskMap</span><span class="p">,</span> <span class="n">maskmapAttr</span><span class="p">,</span> <span class="n">bigmapAttr</span><span class="p">,</span> <span class="n">cutmap</span><span class="p">,</span> <span class="n">cutmapGlobal</span><span class="p">,</span> <span class="n">cutmapFine</span><span class="p">,</span> <span class="n">cutmapVfine</span><span class="p">,</span> <span class="n">metadataNCDF</span>
<span class="k">global</span> <span class="n">timestepInit</span>
<span class="k">global</span> <span class="n">metaNetcdfVar</span>
<span class="k">global</span> <span class="n">inputcounter</span>
<span class="k">global</span> <span class="n">versioning</span>
<span class="k">global</span> <span class="n">meteofiles</span><span class="p">,</span> <span class="n">flagmeteo</span>

<span class="n">versioning</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">timestepInit</span> <span class="o">=</span><span class="p">[]</span>
<span class="n">binding</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">option</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">metaNetcdfVar</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">inputcounter</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">flagmeteo</span> <span class="o">=</span><span class="p">{}</span>
<span class="n">meteofiles</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Initial conditions</span>
<span class="k">global</span> <span class="n">initCondVar</span><span class="p">,</span><span class="n">initCondVarValue</span>
<span class="n">initCondVarValue</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">initCondVar</span> <span class="o">=</span> <span class="p">[]</span>


<span class="c1">#date variable</span>
<span class="k">global</span> <span class="n">dateVar</span>
<span class="c1"># noinspection PyRedeclaration</span>
<span class="n">dateVar</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Output variables</span>
<span class="k">global</span> <span class="n">outDir</span><span class="p">,</span> <span class="n">outsection</span><span class="p">,</span> <span class="n">outputTyp</span>
<span class="k">global</span> <span class="n">outMap</span><span class="p">,</span> <span class="n">outTss</span>
<span class="k">global</span> <span class="n">outputTypMap</span><span class="p">,</span><span class="n">outputTypTss</span><span class="p">,</span> <span class="n">outputTypTss2</span>

<span class="n">outDir</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">outMap</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">outTss</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">outsection</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">outputTypMap</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;monthtot&#39;</span><span class="p">,</span><span class="s1">&#39;monthavg&#39;</span><span class="p">,</span> <span class="s1">&#39;monthend&#39;</span><span class="p">,</span> <span class="s1">&#39;monthmid&#39;</span><span class="p">,</span><span class="s1">&#39;annualtot&#39;</span><span class="p">,</span><span class="s1">&#39;annualavg&#39;</span><span class="p">,</span><span class="s1">&#39;annualend&#39;</span><span class="p">,</span><span class="s1">&#39;totaltot&#39;</span><span class="p">,</span><span class="s1">&#39;totalavg&#39;</span><span class="p">,</span><span class="s1">&#39;totalend&#39;</span><span class="p">,</span><span class="s1">&#39;once&#39;</span><span class="p">,</span><span class="s1">&#39;12month&#39;</span><span class="p">]</span>
<span class="n">outputTypTss</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;monthtot&#39;</span><span class="p">,</span><span class="s1">&#39;monthavg&#39;</span><span class="p">,</span> <span class="s1">&#39;monthend&#39;</span><span class="p">,</span><span class="s1">&#39;annualtot&#39;</span><span class="p">,</span><span class="s1">&#39;annualavg&#39;</span><span class="p">,</span><span class="s1">&#39;annualend&#39;</span><span class="p">,</span><span class="s1">&#39;totaltot&#39;</span><span class="p">,</span><span class="s1">&#39;totalavg&#39;</span><span class="p">]</span>
<span class="n">outputTypTss2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tss&#39;</span><span class="p">,</span> <span class="s1">&#39;areasum&#39;</span><span class="p">,</span><span class="s1">&#39;areaavg&#39;</span><span class="p">]</span>

<span class="n">reportTimeSerieAct</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">reportMapsAll</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">reportMapsSteps</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">reportMapsEnd</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">MMaskMap</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ReportSteps</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">FilterSteps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">EnsMembers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">nrCores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">outputDir</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">maskmapAttr</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">bigmapAttr</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">cutmap</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cutmapGlobal</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cutmapFine</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cutmapVfine</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cdfFlag</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># flag for netcdf output for all, steps and end, monthly (steps), yearly(steps), monthly , yearly</span>
<span class="n">metadataNCDF</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># groundwater modflow</span>
<span class="k">global</span> <span class="n">domain</span><span class="p">,</span> <span class="n">indexes</span>
<span class="n">domain</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">global</span> <span class="n">timeMes</span><span class="p">,</span><span class="n">timeMesString</span><span class="p">,</span> <span class="n">timeMesSum</span>
<span class="n">timeMes</span><span class="o">=</span><span class="p">[]</span>
<span class="n">timeMesString</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># name of the time measure - filled in dynamic</span>
<span class="n">timeMesSum</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1"># time measure of hydrological modules</span>


<span class="k">global</span> <span class="n">coverresult</span>
<span class="n">coverresult</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># -------------------------</span>
<span class="k">global</span> <span class="n">platform1</span>

<span class="n">platform1</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">uname</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># ----------------------------------</span>
<span class="n">FlagName</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;quiet&#39;</span><span class="p">,</span> <span class="s1">&#39;veryquiet&#39;</span><span class="p">,</span> <span class="s1">&#39;loud&#39;</span><span class="p">,</span>
            <span class="s1">&#39;checkfiles&#39;</span><span class="p">,</span> <span class="s1">&#39;noheader&#39;</span><span class="p">,</span> <span class="s1">&#39;printtime&#39;</span><span class="p">,</span><span class="s1">&#39;warranty&#39;</span><span class="p">,</span><span class="s1">&#39;calib&#39;</span><span class="p">,</span><span class="s1">&#39;warm&#39;</span><span class="p">]</span>
<span class="n">Flags</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;quiet&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;veryquiet&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;loud&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
         <span class="s1">&#39;check&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;noheader&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;printtime&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;warranty&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;use&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
         <span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span><span class="s1">&#39;calib&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span><span class="s1">&#39;warm&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>



<span class="n">python_bit</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_voidp</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
<span class="c1">#print &quot;Running under platform: &quot;, platform1</span>
<span class="k">if</span> <span class="n">python_bit</span>  <span class="o">&lt;</span> <span class="mi">64</span><span class="p">:</span>
   <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Error 301: The Python version used is not a 64 bit version! Python &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">python_bit</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;bit&quot;</span>
   <span class="k">raise</span> <span class="n">CWATMError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="n">path_global</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="k">if</span> <span class="n">platform1</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
    <span class="n">dll_routing</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path_global</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;hydrological_modules&quot;</span><span class="p">,</span><span class="s2">&quot;routing_reservoirs&quot;</span><span class="p">,</span><span class="s2">&quot;t5.dll&quot;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">platform1</span> <span class="o">==</span> <span class="s2">&quot;CYGWIN_NT-6.1&quot;</span><span class="p">:</span>
    <span class="c1"># CYGWIN_NT-6.1 - compiled with cygwin</span>
    <span class="n">dll_routing</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path_global</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;hydrological_modules&quot;</span><span class="p">,</span><span class="s2">&quot;routing_reservoirs&quot;</span><span class="p">,</span><span class="s2">&quot;t5cyg.so&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linux</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">dll_routing</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path_global</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;hydrological_modules&quot;</span><span class="p">,</span><span class="s2">&quot;routing_reservoirs&quot;</span><span class="p">,</span><span class="s2">&quot;t5_linux.so&quot;</span><span class="p">)</span>

<span class="c1">#dll_routing = &quot;C:/work2/test1/t4.dll&quot;</span>
<span class="n">lib2</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cdll</span><span class="o">.</span><span class="n">LoadLibrary</span><span class="p">(</span><span class="n">dll_routing</span><span class="p">)</span>

<span class="c1"># setup the return typs and argument types</span>
<span class="c1"># input type for the cos_doubles function</span>
<span class="c1"># must be a double array, with single dimension that is contiguous</span>
<span class="n">array_1d_double</span> <span class="o">=</span> <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;CONTIGUOUS&#39;</span><span class="p">)</span>
<span class="n">array_2d_int</span> <span class="o">=</span> <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">array_1d_int</span> <span class="o">=</span> <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#array_1d_int16 = npct.ndpointer(dtype=np.int16, ndim=1, flags=&#39;CONTIGUOUS&#39;)</span>
<span class="c1">#array_2d_int32 = npct.ndpointer(dtype=np.int32, ndim=2, flags=&#39;CONTIGUOUS&#39;)</span>
<span class="n">array_2d_double</span> <span class="o">=</span> <span class="n">npct</span><span class="o">.</span><span class="n">ndpointer</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s1">&#39;CONTIGUOUS&#39;</span><span class="p">)</span>


<span class="n">lib2</span><span class="o">.</span><span class="n">ups</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">lib2</span><span class="o">.</span><span class="n">ups</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">array_1d_int</span><span class="p">,</span> <span class="n">array_1d_int</span><span class="p">,</span> <span class="n">array_1d_double</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">]</span>

<span class="n">lib2</span><span class="o">.</span><span class="n">dirID</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">lib2</span><span class="o">.</span><span class="n">dirID</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">array_2d_int</span><span class="p">,</span> <span class="n">array_2d_int</span><span class="p">,</span> <span class="n">array_2d_int</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">]</span>

<span class="c1">#lib2.repairLdd1.argtypes = [ array_2d_int, ctypes.c_int,ctypes.c_int]</span>
<span class="n">lib2</span><span class="o">.</span><span class="n">repairLdd1</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span> <span class="n">array_2d_int</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">]</span>

<span class="n">lib2</span><span class="o">.</span><span class="n">repairLdd2</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">lib2</span><span class="o">.</span><span class="n">repairLdd2</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span> <span class="n">array_1d_int</span><span class="p">,</span> <span class="n">array_1d_int</span><span class="p">,</span> <span class="n">array_1d_int</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">]</span>

<span class="n">lib2</span><span class="o">.</span><span class="n">kinematic</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1">#lib2.kinematic.argtypes = [array_1d_double,array_1d_double, array_1d_int, array_1d_int, array_1d_int,  array_1d_double,  ctypes.c_double, ctypes.c_double,ctypes.c_double, ctypes.c_double, ctypes.c_int]</span>
<span class="c1">#                             qold            q               dirdown        diruplen     dirupid         Qnew              alpha             beta            deltaT          deltaX           size</span>
<span class="n">lib2</span><span class="o">.</span><span class="n">kinematic</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">array_1d_double</span><span class="p">,</span><span class="n">array_1d_double</span><span class="p">,</span> <span class="n">array_1d_int</span><span class="p">,</span> <span class="n">array_1d_int</span><span class="p">,</span> <span class="n">array_1d_int</span><span class="p">,</span>  <span class="n">array_1d_double</span><span class="p">,</span>  <span class="n">array_1d_double</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">,</span> <span class="n">array_1d_double</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">]</span>


<span class="n">lib2</span><span class="o">.</span><span class="n">runoffConc</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">lib2</span><span class="o">.</span><span class="n">runoffConc</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">array_2d_double</span><span class="p">,</span><span class="n">array_1d_double</span><span class="p">,</span><span class="n">array_1d_double</span><span class="p">,</span><span class="n">array_1d_double</span><span class="p">,</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">]</span>





<div class="viewcode-block" id="globalFlags"><a class="viewcode-back" href="../../../management_modules.html#cwatm.management_modules.globals.globalFlags">[docs]</a><span class="k">def</span> <span class="nf">globalFlags</span><span class="p">(</span><span class="n">setting</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span><span class="n">settingsfile</span><span class="p">,</span><span class="n">Flags</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read flags - according to the flags the output is adjusted</span>
<span class="sd">    quiet,veryquiet, loud, checkfiles, noheader,printtime, warranty</span>

<span class="sd">    :param arg: argument from calling cwatm</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># put the settingsfile name in a global variable</span>

    <span class="n">settingsfile</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">setting</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">opts</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">getopt</span><span class="o">.</span><span class="n">getopt</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s1">&#39;qvlchtwk0&#39;</span><span class="p">,</span> <span class="n">FlagName</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">getopt</span><span class="o">.</span><span class="n">GetoptError</span><span class="p">:</span>
        <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span>

    <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-q&#39;</span><span class="p">,</span> <span class="s1">&#39;--quiet&#39;</span><span class="p">):</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;quiet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-v&#39;</span><span class="p">,</span> <span class="s1">&#39;--veryquiet&#39;</span><span class="p">):</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;veryquiet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="s1">&#39;--loud&#39;</span><span class="p">):</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;loud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="s1">&#39;--checkfiles&#39;</span><span class="p">):</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;check&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-h&#39;</span><span class="p">,</span> <span class="s1">&#39;--noheader&#39;</span><span class="p">):</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;noheader&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;--printtime&#39;</span><span class="p">):</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;printtime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-w&#39;</span><span class="p">,</span> <span class="s1">&#39;--warranty&#39;</span><span class="p">):</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;warranty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1">#PB21 calibration flag</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="s1">&#39;--calib&#39;</span><span class="p">):</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;calib&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;warm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-0&#39;</span><span class="p">,</span> <span class="s1">&#39;--warm&#39;</span><span class="p">):</span>
            <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;warm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># if testing from pytest</span>
    <span class="k">if</span> <span class="s2">&quot;pytest&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="n">Flags</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, IIASA Water Security.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>